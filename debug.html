<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug ZEVI Character Sheet</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        button { margin: 5px; padding: 10px; }
        .storage-info { background: #f0f0f0; padding: 10px; margin: 10px 0; }
        pre { background: #f5f5f5; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>ZEVI Character Sheet Debug</h1>
    
    <div class="section">
        <h2>Storage Management</h2>
        <button onclick="clearAllStorage()">Clear All Storage</button>
        <button onclick="clearSessionStorage()">Clear Session Storage Only</button>
        <button onclick="clearZeviData()">Clear ZEVI Data Only</button>
        <button onclick="refreshStorageInfo()">Refresh Storage Info</button>
    </div>
    
    <div class="section">
        <h2>Navigation</h2>
        <button onclick="goToLanding()">Go to Landing Page</button>
        <button onclick="goToMain()">Go to Main App</button>
    </div>
    
    <div class="section">
        <h2>Current Storage Contents</h2>
        <div id="storageInfo" class="storage-info">
            Loading...
        </div>
    </div>
    
    <div class="section">
        <h2>Test Actions</h2>
        <button onclick="testCreateCharacter()">Test: Create Character and Load</button>
        <button onclick="testClearAndStart()">Test: Clear All & Start Fresh</button>
        <button onclick="testCreateSampleCharacters()">Test: Create Sample Characters</button>
        <button onclick="testCharacterModal()">Test: Character Modal Display</button>
    </div>

    <script>
        function clearAllStorage() {
            localStorage.clear();
            sessionStorage.clear();
            console.log('All storage cleared');
            refreshStorageInfo();
        }
        
        function clearSessionStorage() {
            sessionStorage.clear();
            console.log('Session storage cleared');
            refreshStorageInfo();
        }
        
        function clearZeviData() {
            const keys = Object.keys(localStorage);
            keys.forEach(key => {
                if (key.startsWith('zevi-')) {
                    localStorage.removeItem(key);
                }
            });
            
            const sessionKeys = Object.keys(sessionStorage);
            sessionKeys.forEach(key => {
                if (key.startsWith('zevi-')) {
                    sessionStorage.removeItem(key);
                }
            });
            
            console.log('ZEVI data cleared');
            refreshStorageInfo();
        }
        
        function refreshStorageInfo() {
            const storageDiv = document.getElementById('storageInfo');
            let info = '<h3>localStorage:</h3><pre>';
            
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                const value = localStorage.getItem(key);
                info += key + ': ' + (value.length > 100 ? value.substring(0, 100) + '...' : value) + '\n';
            }
            
            info += '</pre><h3>sessionStorage:</h3><pre>';
            
            for (let i = 0; i < sessionStorage.length; i++) {
                const key = sessionStorage.key(i);
                const value = sessionStorage.getItem(key);
                info += key + ': ' + value + '\n';
            }
            
            info += '</pre>';
            storageDiv.innerHTML = info;
        }
        
        function goToLanding() {
            window.location.href = 'landing.html';
        }
        
        function goToMain() {
            window.location.href = 'index.html';
        }
        
        function testCreateCharacter() {
            // Create a test character
            const testCharacter = {
                id: Date.now().toString(),
                name: 'Test Character',
                subtitle: 'Test Subtitle',
                level: 1,
                createdAt: new Date().toISOString(),
                lastModified: new Date().toISOString()
            };
            
            // Store it
            localStorage.setItem('zevi-characters', JSON.stringify([testCharacter]));
            localStorage.setItem('zevi-current-character-id', testCharacter.id);
            
            console.log('Test character created:', testCharacter);
            refreshStorageInfo();
            
            alert('Test character created. Try navigating to landing or main page.');
        }
        
        function testClearAndStart() {
            clearAllStorage();
            goToLanding();
        }
        
        function testCreateSampleCharacters() {
            const sampleCharacters = [
                {
                    id: Date.now().toString(),
                    name: 'Aria Shadowbane',
                    subtitle: 'Human Rogue • Shadowheart Domain',
                    level: 5,
                    platform: 'Daggerheart',
                    imageUrl: '',
                    domains: ['Shadowheart', 'Knowledge'],
                    attributes: { agility: 12, strength: 8, finesse: 14, instinct: 10, presence: 9, knowledge: 11 },
                    hp: { current: 25, max: 25 },
                    stress: { current: 0, max: 10 },
                    evasion: 12,
                    createdAt: new Date().toISOString(),
                    lastModified: new Date().toISOString()
                },
                {
                    id: (Date.now() + 1).toString(),
                    name: 'Thorin Ironforge',
                    subtitle: 'Dwarf Fighter',
                    level: 8,
                    platform: 'Dungeons & Dragons',
                    imageUrl: '',
                    domains: [],
                    attributes: { might: 16, agility: 10, intellect: 12, charm: 8 },
                    hp: { current: 68, max: 68 },
                    stress: { current: 2, max: 12 },
                    evasion: 10,
                    createdAt: new Date(Date.now() - 86400000).toISOString(), // 1 day ago
                    lastModified: new Date().toISOString()
                },
                {
                    id: (Date.now() + 2).toString(),
                    name: 'Luna Starweaver',
                    subtitle: 'Elf Wizard • Arcana Domain',
                    level: 3,
                    platform: 'Daggerheart',
                    imageUrl: '',
                    domains: ['Arcana', 'Splendor'],
                    attributes: { agility: 10, strength: 6, finesse: 12, instinct: 13, presence: 11, knowledge: 15 },
                    hp: { current: 18, max: 18 },
                    stress: { current: 1, max: 8 },
                    evasion: 11,
                    createdAt: new Date(Date.now() - 172800000).toISOString(), // 2 days ago
                    lastModified: new Date().toISOString()
                }
            ];

            localStorage.setItem('zevi-characters', JSON.stringify(sampleCharacters));
            localStorage.setItem('zevi-current-character-id', sampleCharacters[0].id);

            console.log('Sample characters created:', sampleCharacters);
            refreshStorageInfo();

            alert('Sample characters created with different platforms! Navigate to the main app and click the "Characters" tab to see them.');
        }
        
        function testCharacterModal() {
            // Create a simple modal test
            const modalHTML = `
                <div id="testModal" style="
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.8);
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    z-index: 10000;
                ">
                    <div style="
                        background: white;
                        padding: 2rem;
                        border-radius: 8px;
                        max-width: 400px;
                        text-align: center;
                        color: black;
                    ">
                        <h3>Modal Test Successful!</h3>
                        <p>If you can see this, modals are working.</p>
                        <button onclick="document.getElementById('testModal').remove()">Close</button>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            
            setTimeout(() => {
                const testModal = document.getElementById('testModal');
                if (testModal) {
                    testModal.remove();
                    alert('Modal test completed. Now try the character modal in the main app.');
                }
            }, 3000);
        }
        
        // Load storage info on page load
        document.addEventListener('DOMContentLoaded', refreshStorageInfo);
    </script>
</body>
</html>